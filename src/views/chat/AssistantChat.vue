<script setup lang="ts">
import { ref } from 'vue'
const props = defineProps({
  content: {
    type: String,
    default: ''
  },
  stream: {
    type: Boolean,
    default: false
  }
})

let contentStream = ref('')
let index = 0

function writing() {
  if (index < props.content.length) {
    contentStream.value += props.content[index++]
    requestAnimationFrame(writing)
  }
}

if (props.stream) {
  writing()
} else {
  contentStream.value = props.content
}
</script>

<template>
  <div class="chat-assistant">
    <el-icon size="32px">
      <svg viewBox="0 0 1029 1024" xmlns="http://www.w3.org/2000/svg" style="font-size: 20px">
        <path
          d="M930.436044 984.868771c-5.886057 0-11.676947-1.604544-16.746406-4.640694L718.800973 863.526145l-5.101181 1.940189c-63.631226 24.209378-131.499963 36.484959-201.721281 36.484959-276.073686 0-500.67507-193.529715-500.67507-431.410544 0-237.879805 224.601384-431.40952 500.674047-431.40952 276.073686 0 500.67507 193.529715 500.67507 431.40952 0 51.981908-10.517541 102.703103-31.262004 150.753469-20.73423 48.02683-51.16224 92.189655-90.437755 131.260509l-5.359055 5.331425 75.218122 180.538843c5.572926 13.362332 2.060939 28.728298-8.740058 38.241976C946.078303 981.958488 938.396343 984.868771 930.436044 984.868771zM721.516828 792.899598c5.885034 0 11.68411 1.606591 16.768919 4.64581l122.909307 73.596182-45.486984-109.189841c-5.613858-13.459546-2.031263-28.889981 8.911974-38.400588 78.733179-68.390623 122.094756-158.245094 122.094756-253.010411 0-201.01213-195.022719-364.546693-434.737312-364.546693-239.714594 0-434.736289 163.535587-434.736289 364.547717 0 201.011106 195.022719 364.544647 434.736289 364.544647 69.12024 0 135.309732-13.311167 196.72857-39.564088C712.784956 793.782711 717.098191 792.899598 721.516828 792.899598zM504.605589 523.087523c-26.307156 0-47.710628-21.679765-47.710628-48.328705s21.402449-48.328705 47.710628-48.328705 47.711652 21.679765 47.711652 48.328705S530.913768 523.087523 504.605589 523.087523zM694.436052 522.317996c-25.036209-0.255827-45.613874-21.084201-45.896306-46.441729l0-1.055029c0.283456-25.613354 21.066805-46.443775 46.352701-46.443775l0.480954 0.002047c25.566282 0.260943 46.155203 21.545712 45.89733 47.445592-0.257873 25.63689-21.051455 46.493917-46.353724 46.493917L694.436052 522.317996zM311.150576 522.317996c-25.036209-0.255827-45.614897-21.085224-45.896306-46.441729l0-1.054005c0.284479-25.613354 21.066805-46.443775 46.351678-46.443775l0.480954 0.002047c25.567305 0.260943 46.156226 21.545712 45.89733 47.445592-0.25685 25.63689-21.050432 46.493917-46.352701 46.493917L311.150576 522.317996z"
          fill="#ffffff"
          p-id="10662"
        ></path>
      </svg>
    </el-icon>

    <p class="chat-content">
      {{ contentStream }}
    </p>
  </div>
</template>

<style lang="scss" scoped>
.chat-assistant {
  display: flex;
  gap: 8px;
  align-items: flex-start;
  padding: 16px 0 16px 16px;
  font-size: 16px;
  border-radius: 8px;

  .el-icon {
    color: #fff;
    background-color: #165dff;
    border-radius: 8px;
  }

  .chat-content {
    flex: 1;
    margin-top: 0;
    line-height: 25px;
    white-space: pre-wrap;
  }
}
</style>
